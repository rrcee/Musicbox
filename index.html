<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Glass </title>
  

</head>
<body>
<!-- partial:index.partial.html -->
<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="utf-8" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>MP33 — Glass Player</title>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<style>

  /* iOS-like font stack */

  :root{

    --glass: rgba(255,255,255,.10);

    --glass-strong: rgba(255,255,255,.16);

    --on-glass: rgba(255,255,255,.92);

    --shadow: rgba(0,0,0,.6);

    --art-radius: 22px;

    --tint-0: rgba(0,0,0,.35);

    --tint-1: rgba(0,0,0,.55);

  }

  *{box-sizing:border-box}

  html,body{height:100%}

  body{

    margin:0;

    color:#fff;

    font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","SF Pro Display",system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;

    background:#000;

    overflow:hidden;

  }

  /* Blurred background driven by album art */

  .bg {

    position:fixed; inset:0;

    background:#000 center/cover no-repeat;

    filter:blur(28px) brightness(.55);

    transform:scale(1.05); /* hide blur edges */

    transition:background-image .45s ease;

    z-index:-2;

  }

  .bg-tint {

    position:fixed; inset:0;

    background:linear-gradient(180deg,var(--tint-0),var(--tint-1));

    pointer-events:none;

    z-index:-1;

    opacity:.9;

    transition:opacity .3s ease;

  }

  /* Main card */

  .wrap{

    height:100%; width:100%;

    display:flex; align-items:center; justify-content:center;

    padding:24px;

  }

  .card{

    width:100%; max-width:430px;

    border-radius:24px;

    background:var(--glass);

    backdrop-filter:blur(18px) saturate(180%);

    -webkit-backdrop-filter:blur(18px) saturate(180%);

    box-shadow:0 18px 50px var(--shadow);

    padding:18px 18px 12px;

    display:flex; flex-direction:column; align-items:center;

    gap:14px;

  }

  /* Album art */

  .art{

    width:100%; border-radius:var(--art-radius);

    overflow:hidden; position:relative;

    box-shadow:0 12px 40px var(--shadow);

  }

  .art img{display:block; width:100%; height:auto; transition:opacity .35s ease}

  .title{

    width:100%; text-align:left;

  }

  .title h1{font-size:22px; line-height:1.2; margin:2px 0 4px; font-weight:700}

  .title p{font-size:14px; opacity:.85; margin:0}

  /* Uploads */

  .uploads{display:flex; gap:12px; width:100%; margin-top:6px}

  .btn-upload{

    flex:1; text-align:center; padding:10px 12px; cursor:pointer;

    border-radius:14px; background:var(--glass-strong); color:var(--on-glass);

    backdrop-filter:blur(12px); -webkit-backdrop-filter:blur(12px);

    user-select:none;

  }

  input[type=file]{display:none}

  /* Seekbar */

  .seek-wrap{width:100%; margin:2px 0 0}

  .time-row{display:flex; justify-content:space-between; font-size:12px; opacity:.9; margin:4px 0 6px}

  input[type=range].seek{

    width:100%; height:4px; border-radius:2px; background:rgba(255,255,255,.28);

    -webkit-appearance:none; appearance:none; outline:none;

  }

  .seek::-webkit-slider-thumb{

    -webkit-appearance:none; appearance:none; width:14px; height:14px;

    border-radius:50%; background:#fff; box-shadow:0 0 0 3px rgba(255,255,255,.25) inset;

    cursor:pointer;

  }

  .seek::-moz-range-thumb{

    width:14px; height:14px; border:none; border-radius:50%; background:#fff; cursor:pointer;

  }

  /* Transport controls (pure CSS shapes, no icons) */

  .transport{

    display:flex; align-items:center; justify-content:center; gap:26px; width:100%; margin:4px 0 8px;

  }

  .btn{

    width:58px; height:58px; border-radius:50%;

    display:flex; align-items:center; justify-content:center;

    background:var(--on-glass); color:#000; cursor:pointer; user-select:none;

    box-shadow:0 10px 30px var(--shadow);

  }

  .btn-secondary{

    width:50px; height:50px; background:rgba(255,255,255,.15); color:#fff;

    backdrop-filter:blur(10px); -webkit-backdrop-filter:blur(10px);

    box-shadow:none;

  }

  .btn:active{transform:scale(.98)}

  /* CSS icons */

  .tri-right{ /* play / next body */

    width:0; height:0; border-top:12px solid transparent; border-bottom:12px solid transparent; border-left:20px solid currentColor;

  }

  .pause-bars{display:flex; gap:6px}

  .pause-bars .bar{width:6px; height:22px; background:currentColor; border-radius:2px}

  .skip-body{width:0; height:0; border-top:11px solid transparent; border-bottom:11px solid transparent; border-left:18px solid currentColor}

  .skip-line{width:3px; height:22px; background:currentColor; margin-left:4px; border-radius:1.5px}

  /* Bottom row */

  .bottom{

    display:flex; justify-content:space-between; width:100%; padding-top:8px;

  }

  .link{

    background:var(--glass-strong); padding:10px 14px; border-radius:12px;

    backdrop-filter:blur(10px); -webkit-backdrop-filter:blur(10px);

    cursor:pointer; user-select:none;

  }

  /* Overlays */

  .overlay{

    position:fixed; inset:0; display:none; align-items:flex-end; justify-content:center;

    background:rgba(0,0,0,.35);

  }

  .sheet{

    width:100%; max-width:480px; background:var(--glass); color:#fff; border-top-left-radius:18px; border-top-right-radius:18px;

    backdrop-filter:blur(18px) saturate(180%); -webkit-backdrop-filter:blur(18px) saturate(180%);

    box-shadow:0 -12px 40px var(--shadow); padding:16px;

    max-height:72vh; overflow:auto;

  }

  .sheet h3{margin:6px 0 12px}

  .upnext-item{

    padding:10px 12px; border-radius:12px; background:rgba(255,255,255,.08);

    margin-bottom:8px; display:flex; gap:10px; align-items:center; cursor:grab;

  }

  .dot{width:8px; height:8px; border-radius:50%; background:#fff; opacity:.75}

  .row{display:flex; align-items:center; justify-content:space-between; gap:10px}

  .toggle{

    appearance:none; width:42px; height:26px; background:rgba(255,255,255,.22); border-radius:26px; position:relative; outline:none; cursor:pointer;

  }

  .toggle:checked{background:#fff}

  .toggle:before{

    content:""; position:absolute; top:3px; left:3px; width:20px; height:20px; border-radius:50%; background:#fff; transition:left .18s ease, background .18s ease;

  }

  .toggle:checked:before{left:19px; background:#000}

  .sheet .small{font-size:13px; opacity:.85}

  .hide{display:none}

</style>

</head>

<body>

  <!-- dynamic blurred background -->

  <div id="bg" class="bg"></div>

  <div id="bgTint" class="bg-tint"></div>

  <div class="wrap">

    <div class="card">

      <div class="art">

        <img id="artImg" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='800'%3E%3Crect width='100%25' height='100%25' fill='%23000'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='%23fff' font-family='Arial' font-size='28'%3EUpload music to begin%3C/text%3E%3C/svg%3E" alt="Album art">

      </div>

      <div class="title">

        <h1 id="trackTitle">No Track</h1>

        <p id="trackArtist">—</p>

      </div>

      <div class="uploads">

        <label class="btn-upload">Folder<input id="folderInput" type="file" webkitdirectory directory multiple accept="audio/*"></label>

        <label class="btn-upload">File<input id="fileInput" type="file" multiple accept="audio/*"></label>

      </div>

      <div class="seek-wrap">

        <input id="seek" class="seek" type="range" value="0" min="0" step="1">

        <div class="time-row">

          <span id="cur">0:00</span>

          <span id="dur">0:00</span>

        </div>

      </div>

      <div class="transport">

        <!-- PREV -->

        <div id="prev" class="btn btn-secondary" aria-label="Previous">

          <div style="display:flex; align-items:center; color:#fff;">

            <div class="skip-line"></div>

            <div class="skip-body" style="transform:scaleX(-1); margin-left:4px;"></div>

          </div>

        </div>

        <!-- PLAY/PAUSE -->

        <div id="playPause" class="btn" aria-label="Play">

          <div id="iconPlay" class="tri-right"></div>

        </div>

        <!-- NEXT -->

        <div id="next" class="btn btn-secondary" aria-label="Next">

          <div style="display:flex; align-items:center; color:#fff;">

            <div class="skip-body"></div>

            <div class="skip-line"></div>

          </div>

        </div>

      </div>

      <div class="bottom">

        <div id="openQueue" class="link">UP NEXT</div>

        <div id="openSettings" class="link">SETTINGS</div>

      </div>

    </div>

  </div>

  <!-- Up Next overlay -->

  <div id="queueOv" class="overlay" role="dialog" aria-modal="true">

    <div class="sheet">

      <div class="row"><h3>Up Next</h3><div id="closeQueue" class="link">Close</div></div>

      <div id="queueList"></div>

    </div>

  </div>

  <!-- Settings overlay -->

  <div id="settingsOv" class="overlay" role="dialog" aria-modal="true">

    <div class="sheet">

      <div class="row"><h3>Settings</h3><div id="closeSettings" class="link">Close</div></div>

      <div class="row" style="margin:10px 0;">

        <div>

          <div>Rounded album art</div>

          <div class="small">Toggle between rounded and square corners.</div>

        </div>

        <input id="setRounded" type="checkbox" class="toggle" checked>

      </div>

      <div class="row" style="margin:10px 0;">

        <div>

          <div>Progressive background tint</div>

          <div class="small">Dim the blurred background for contrast.</div>

        </div>

        <input id="setTint" type="checkbox" class="toggle" checked>

      </div>

    </div>

  </div>

  <audio id="audio"></audio>

  <!-- ID3 tag reader for cover/title/artist -->

  <script src="https://cdn.jsdelivr.net/npm/jsmediatags@3.9.7/dist/jsmediatags.min.js"></script>

  <script>

  const audio = document.getElementById('audio');

  const artImg = document.getElementById('artImg');

  const bg = document.getElementById('bg');

  const bgTint = document.getElementById('bgTint');

  const titleEl = document.getElementById('trackTitle');

  const artistEl = document.getElementById('trackArtist');

  const seek = document.getElementById('seek');

  const cur = document.getElementById('cur');

  const dur = document.getElementById('dur');

  const fileInput = document.getElementById('fileInput');

  const folderInput = document.getElementById('folderInput');

  const playPause = document.getElementById('playPause');

  const prevBtn = document.getElementById('prev');

  const nextBtn = document.getElementById('next');

  const queueOv = document.getElementById('queueOv');

  const openQueue = document.getElementById('openQueue');

  const closeQueue = document.getElementById('closeQueue');

  const queueList = document.getElementById('queueList');

  const settingsOv = document.getElementById('settingsOv');

  const openSettings = document.getElementById('openSettings');

  const closeSettings = document.getElementById('closeSettings');

  const setRounded = document.getElementById('setRounded');

  const setTint = document.getElementById('setTint');

  let playlist = [];      // [{file, url, title, artist, cover}]

  let current = -1;

  let playing = false;

  // Helpers

  const fmt = s => isNaN(s)?'0:00':`${Math.floor(s/60)}:${String(Math.floor(s%60)).padStart(2,'0')}`;

  function setPlayIcon(isPlaying){

    playPause.innerHTML = isPlaying

      ? '<div class="pause-bars"><div class="bar"></div><div class="bar"></div></div>'

      : '<div class="tri-right"></div>';

    playPause.setAttribute('aria-label', isPlaying? 'Pause':'Play');

  }

  function updateBackground(src){

    bg.style.backgroundImage = `url('${src}')`;

    artImg.style.opacity = '0.8';

    setTimeout(()=> artImg.style.opacity='1', 80);

  }

  function extractTags(file){

    return new Promise(resolve=>{

      window.jsmediatags.read(file, {

        onSuccess: tag => {

          const out = { title: tag.tags.title || file.name.replace(/\.[^/.]+$/,''),

                        artist: tag.tags.artist || 'Unknown Artist',

                        cover: null };

          if (tag.tags.picture){

            const { data, format } = tag.tags.picture;

            let base64 = '';

            for (let i=0;i<data.length;i++) base64 += String.fromCharCode(data[i]);

            out.cover = `data:${format};base64,${btoa(base64)}`;

          }

          resolve(out);

        },

        onError: _ => resolve({

          title: file.name.replace(/\.[^/.]+$/,''),

          artist: 'Unknown Artist',

          cover: null

        })

      });

    });

  }

  async function addFiles(fileList){

    const audios = [...fileList].filter(f => f.type.startsWith('audio/'));

    for (const f of audios){

      const url = URL.createObjectURL(f);

      const tags = await extractTags(f);

      playlist.push({ file:f, url, ...tags });

    }

    if (current === -1 && playlist.length){ load(0); }

    renderQueue();

  }

  function load(index){

    if (!playlist[index]) return;

    current = index;

    const t = playlist[index];

    audio.src = t.url;

    titleEl.textContent = t.title || 'Unknown';

    artistEl.textContent = t.artist || 'Unknown Artist';

    if (t.cover){

      artImg.src = t.cover;

      updateBackground(t.cover);

    } else {

      // fallback: solid black SVG with title text

      const svg = `data:image/svg+xml,${encodeURIComponent(

        `<svg xmlns='http://www.w3.org/2000/svg' width='800' height='800'>

          <rect width='100%' height='100%' fill='#000'/>

          <text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle'

            fill='#fff' font-family='Arial' font-size='28'>${(t.title||'Track')}</text>

        </svg>`

      )}`;

      artImg.src = svg;

      updateBackground(svg);

    }

    audio.load();

    play();

    renderQueue();

  }

  function play(){ audio.play(); playing=true; setPlayIcon(true); }

  function pause(){ audio.pause(); playing=false; setPlayIcon(false); }

  function next(){ if (current < playlist.length-1){ load(current+1); } }

  function prev(){ if (current > 0){ load(current-1); } }

  // UI events

  playPause.addEventListener('click', ()=> playing?pause():play());

  nextBtn.addEventListener('click', next);

  prevBtn.addEventListener('click', prev);

  fileInput.addEventListener('change', e=> addFiles(e.target.files));

  folderInput.addEventListener('change', e=> addFiles(e.target.files));

  // Progress

  audio.addEventListener('loadedmetadata', ()=>{

    seek.max = Math.floor(audio.duration||0);

    dur.textContent = fmt(audio.duration);

  });

  audio.addEventListener('timeupdate', ()=>{

    seek.max = Math.floor(audio.duration||0);

    seek.value = Math.floor(audio.currentTime||0);

    cur.textContent = fmt(audio.currentTime);

    dur.textContent = fmt(audio.duration);

  });

  seek.addEventListener('input', ()=> { audio.currentTime = seek.value; });

  audio.addEventListener('ended', ()=> {

    // stop at end of playlist (as requested)

    if (current < playlist.length-1) next(); else pause();

  });

  // Overlays

  openQueue.onclick = ()=> queueOv.style.display='flex';

  closeQueue.onclick = ()=> queueOv.style.display='none';

  openSettings.onclick = ()=> settingsOv.style.display='flex';

  closeSettings.onclick = ()=> settingsOv.style.display='none';

  setRounded.onchange = (e)=> {

    document.documentElement.style.setProperty('--art-radius', e.target.checked? '22px':'8px');

  };

  setTint.onchange = (e)=> { bgTint.style.opacity = e.target.checked? '.9':'0'; };

  // Queue render + drag reorder

  function renderQueue(){

    queueList.innerHTML = '';

    playlist.forEach((t, i)=>{

      const item = document.createElement('div');

      item.className = 'upnext-item';

      item.draggable = true;

      item.dataset.index = i;

      item.innerHTML = `

        <div class="dot"></div>

        <div style="flex:1; min-width:0;">

          <div style="font-weight:600; font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">${t.title||'Unknown'}</div>

          <div style="opacity:.85; font-size:12px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">${t.artist||'Unknown Artist'}</div>

        </div>

        <div class="link">Play</div>

      `;

      if (i===current){ item.style.outline='2px solid rgba(255,255,255,.35)'; }

      item.querySelector('.link').onclick = ()=>{ load(i); };

      item.addEventListener('dragstart', e=>{

        e.dataTransfer.setData('text/plain', i.toString());

      });

      item.addEventListener('dragover', e=> e.preventDefault());

      item.addEventListener('drop', e=>{

        e.preventDefault();

        const from = +e.dataTransfer.getData('text/plain');

        const to = +item.dataset.index;

        if (from===to) return;

        const [m] = playlist.splice(from,1);

        playlist.splice(to,0,m);

        if (from===current) current = to;

        else if (from<current && to>=current) current--;

        else if (from>current && to<=current) current++;

        renderQueue();

      });

      queueList.appendChild(item);

    });

  }

  </script>

</body>

</html>
<!-- partial -->
  
</body>
</html>
